import{a as E,b as f,c as F,d as D,f as y,g as x,h as T,i as w,j as N,k as R,l as A,n as z}from"./chunk-6WTLAR56.js";import{a as V}from"./chunk-S6LUAGNY.js";import{a as q}from"./chunk-OR4RGIIA.js";import{a as j}from"./chunk-FDL334H3.js";import{a as L}from"./chunk-XF56FPVL.js";import{c as M,d as O}from"./chunk-7R7WLGXG.js";import{G as m,H as c,I as k,J as _,K as p,L as n,M as r,N as l,P as h,T as u,V as s,W as b,ma as S,sa as I,ua as P,w as o,y as d,z as C}from"./chunk-Q353D5L7.js";import{d as B}from"./chunk-KAT7YFEL.js";var v=B(L());var $=(a,e)=>e.id;function H(a,e){a&1&&(n(0,"div",6),s(1," El t\xEDtulo es obligatorio. "),r())}function J(a,e){a&1&&(n(0,"div",6),s(1," La descripci\xF3n es obligatoria. "),r())}function K(a,e){if(a&1&&(n(0,"option",12),s(1),r()),a&2){let t=e.$implicit;p("ngValue",t.id),o(),b(t.name)}}function Q(a,e){a&1&&(n(0,"div",6),s(1," Debe seleccionar un desarrollador. "),r())}function U(a,e){a&1&&(n(0,"div",6),s(1," La fecha de inicio es obligatoria y debe ser desde hoy en adelante. "),r())}function W(a,e){a&1&&(n(0,"div",6),s(1," La fecha de fin es obligatoria y debe ser igual o posterior a la de inicio. "),r())}var G=class a{constructor(e,t,i,g,X,Y){this.fb=e;this.taskService=t;this.developerService=i;this.notificationService=g;this.router=X;this.route=Y}taskForm;developers=[];isEdit=!1;taskId=null;today=new Date().toISOString().split("T")[0];task=null;ngOnInit(){this.taskId=this.route.snapshot.params.id?+this.route.snapshot.params.id:null,this.isEdit=!!this.taskId,this.initForm(),this.loadDevelopers(()=>{this.isEdit&&this.loadTask()})}initForm(){this.taskForm=this.fb.group({title:["",f.required],description:["",f.required],developerId:["",f.required],startDate:["",f.required],endDate:["",f.required]},{validators:this.dateValidator})}dateValidator(e){let t=e.get("startDate")?.value,i=e.get("endDate")?.value;return t&&i&&i<t?{dateInvalid:!0}:null}isInvalid(e){let t=this.taskForm.get(e);return!!t&&t.invalid&&(t.dirty||t.touched)}loadDevelopers(e){this.developerService.getAll().subscribe({next:t=>{this.developers=t,e&&e()},error:t=>this.showError(t)})}loadTask(){this.taskId&&this.taskService.getById(this.taskId).subscribe({next:e=>{this.task=e,this.taskForm.patchValue({title:e.title,description:e.description,developerId:e.id,startDate:e.startDate,endDate:e.endDate})},error:e=>this.showError(e)})}onSubmit(){if(this.taskForm.invalid){this.taskForm.markAllAsTouched(),v.default.fire("Error","Por favor complete todos los campos correctamente.","error");return}let e=this.taskForm.value;this.isEdit&&this.taskId?this.taskService.update(this.taskId,e).subscribe({next:()=>{v.default.fire("Actualizado","La tarea fue actualizada correctamente.","success"),this.router.navigate(["/tasks"])},error:t=>this.showError(t)}):this.taskService.create(e).subscribe({next:()=>{v.default.fire("Creado","La tarea fue creada correctamente.","success"),this.router.navigate(["/tasks"])},error:t=>this.showError(t)})}cancel(){this.router.navigate(["/tasks"])}showError(e){let t=e?.error?.detail||e?.error?.message||e?.message||"Error inesperado";v.default.fire("Error",t,"error")}static \u0275fac=function(t){return new(t||a)(d(A),d(V),d(j),d(q),d(P),d(I))};static \u0275cmp=C({type:a,selectors:[["app-task-form"]],decls:40,vars:21,consts:[[1,"task-form-container"],[1,"title"],["novalidate","",3,"ngSubmit","formGroup"],[1,"form-group"],["for","title"],["id","title","formControlName","title","type","text"],[1,"form-error"],["for","description"],["id","description","formControlName","description"],["for","developerId"],["id","developerId","formControlName","developerId"],["value",""],[3,"ngValue"],["for","startDate"],["id","startDate","formControlName","startDate","type","date",3,"min"],["for","endDate"],["id","endDate","formControlName","endDate","type","date",3,"min"],[1,"form-actions"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(t,i){if(t&1&&(l(0,"app-navbar"),n(1,"div",0)(2,"h2",1),s(3),r(),n(4,"form",2),h("ngSubmit",function(){return i.onSubmit()}),n(5,"div",3)(6,"label",4),s(7,"T\xEDtulo"),r(),l(8,"input",5),m(9,H,2,0,"div",6),r(),n(10,"div",3)(11,"label",7),s(12,"Descripci\xF3n"),r(),l(13,"textarea",8),m(14,J,2,0,"div",6),r(),n(15,"div",3)(16,"label",9),s(17,"Desarrollador"),r(),n(18,"select",10)(19,"option",11),s(20,"Seleccione un desarrollador"),r(),k(21,K,2,2,"option",12,$),r(),m(23,Q,2,0,"div",6),r(),n(24,"div",3)(25,"label",13),s(26,"Fecha de inicio"),r(),l(27,"input",14),m(28,U,2,0,"div",6),r(),n(29,"div",3)(30,"label",15),s(31,"Fecha de fin"),r(),l(32,"input",16),m(33,W,2,0,"div",6),r(),n(34,"div",17)(35,"button",18),s(36),r(),n(37,"button",19),h("click",function(){return i.cancel()}),s(38,"Cancelar"),r()()()(),l(39,"app-footer")),t&2){let g;o(3),b(i.isEdit?"Editar Tarea":"Nueva Tarea"),o(),p("formGroup",i.taskForm),o(4),u("error",i.isInvalid("title")),o(),c(i.isInvalid("title")?9:-1),o(4),u("error",i.isInvalid("description")),o(),c(i.isInvalid("description")?14:-1),o(4),u("error",i.isInvalid("developerId")),o(3),_(i.developers),o(2),c(i.isInvalid("developerId")?23:-1),o(4),u("error",i.isInvalid("startDate")),p("min",i.today),o(),c(i.isInvalid("startDate")?28:-1),o(4),u("error",i.isInvalid("endDate")),p("min",((g=i.taskForm.get("startDate"))==null?null:g.value)||i.today),o(),c(i.isInvalid("endDate")?33:-1),o(2),p("disabled",i.taskForm.invalid),o(),b(i.isEdit?"Actualizar":"Crear")}},dependencies:[S,z,y,N,R,E,w,F,D,x,T,M,O],styles:[`.task-form-container[_ngcontent-%COMP%]{max-width:600px;margin:2.5rem auto;background:#fff;border-radius:1.5rem;box-shadow:0 4px 16px #1e293b14;padding:2.5rem 2rem}.title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#1e293b;margin-bottom:2rem;text-align:center}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.3rem;margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#4a5568}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:.6rem .9rem;border:1px solid #cbd5e1;border-radius:7px;font-size:1rem;background:#f7fafc;transition:border .2s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:#4f46e5;outline:none}.form-error[_ngcontent-%COMP%]{color:#ef4444;font-size:.95rem;margin-top:.2rem}.form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:1.5rem}.btn-primary[_ngcontent-%COMP%]{background:#4f46e5;color:#fff;border:none;border-radius:.5rem;padding:.7rem 1.5rem;font-weight:600;font-size:1rem;cursor:pointer;transition:background .2s}.btn-primary[_ngcontent-%COMP%]:hover{background:#3730a3}.btn-secondary[_ngcontent-%COMP%]{background:#f3f4f6;color:#1e293b;border:none;border-radius:.5rem;padding:.7rem 1.5rem;font-weight:600;font-size:1rem;cursor:pointer;transition:background .2s}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e5e7eb}@media (max-width: 600px){.task-form-container[_ngcontent-%COMP%]{padding:1.2rem .5rem}.form-actions[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}}.loading[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:#4f46e5;font-weight:500}.loading-spinner[_ngcontent-%COMP%]{width:1.2rem;height:1.2rem;border:2px solid #c7d2fe;border-top:2px solid #4f46e5;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}select.form-control[_ngcontent-%COMP%]{appearance:none;background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");background-position:right .5rem center;background-repeat:no-repeat;background-size:1.5em 1.5em;padding-right:2.5rem}input[type=date].form-control[_ngcontent-%COMP%]{padding:.75rem 1rem;font-family:inherit}.loading[_ngcontent-%COMP%]{opacity:.7;pointer-events:none}.loading[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;left:50%;width:1.5rem;height:1.5rem;border:2px solid #e5e7eb;border-top-color:#4f46e5;border-radius:50%;animation:_ngcontent-%COMP%_spin .6s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}`]})};export{G as TaskFormComponent};
